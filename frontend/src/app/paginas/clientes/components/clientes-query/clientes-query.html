<div class="my-8 px-8">
  <!-- FILTROS -->
  <form [formGroup]="filtroForm" (ngSubmit)="obtenerClientes()" class="flex gap-5 mb-6">
    <mat-form-field appearance="fill">
      <mat-label>Seleccionar filtro</mat-label>
      <mat-select (selectionChange)="handleSelectChange($event)">
        @for (fil of selectFiltros(); track $index) {
        <mat-option [value]="fil.value">{{ fil.viewValue }}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    @if (filtroSeleccionado() === 'documento') {
    <mat-form-field appearance="fill">
      <mat-label>Tipo de documento</mat-label>
      <mat-select formControlName="tipoDocumento">
        @for (td of tiposDocumento(); track $index) {
          <mat-option [value]="td">{{ td }}</mat-option>
        }
      </mat-select>
    </mat-form-field>

    <mat-form-field appearance="fill">
      <mat-label>Documento</mat-label>
      <input matInput formControlName="documento" placeholder="Número de documento" />
    </mat-form-field>
    }@else if (filtroSeleccionado() === 'rangoFecha') {
    <mat-form-field appearance="fill">
      <mat-label>Ingrese dos fechas</mat-label>
      <mat-date-range-input [rangePicker]="picker">
        <input matStartDate placeholder="Fecha de inicio" formControlName="desde" />
        <input matEndDate placeholder="Fecha de fin" formControlName="hasta" />
      </mat-date-range-input>
      <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-date-range-picker #picker></mat-date-range-picker>
    </mat-form-field>
    }@else if (filtroSeleccionado() === 'search') {
    <mat-form-field appearance="fill">
      <mat-label>Búsqueda general</mat-label>
      <input matInput formControlName="search" placeholder="Nombre o correo" />
    </mat-form-field>
    } @if (filtroSeleccionado() != null) {
    <button
      mat-flat-button
      color="primary"
      class="bg-blue-600 hover:bg-blue-500 h-14 p-2 rounded text-white"
      type="submit"
    >
      Buscar
    </button>
    }
  </form>

  <!-- TABLA -->
  <div class="overflow-x-auto rounded-lg">
    <table
      mat-table
      [dataSource]="datasource()"
      class="min-w-full border border-gray-200! dark:border-gray-700! rounded-lg"
    >
      <!-- Nombre -->
      <ng-container matColumnDef="nombre">
        <th
          mat-header-cell
          *matHeaderCellDef
          class="text-left py-3 px-4 font-semibold bg-gray-100! dark:bg-[#0f172a]!"
        >
          Nombre
        </th>
        <td mat-cell *matCellDef="let element" class="py-3 px-4 border-t dark:border-gray-800!">
          {{ element.nombre }}
        </td>
      </ng-container>

      <!-- Apellido -->
      <ng-container matColumnDef="apellido">
        <th
          mat-header-cell
          *matHeaderCellDef
          class="text-left py-3 px-4 font-semibold bg-gray-100! dark:bg-[#0f172a]!"
        >
          Apellido
        </th>
        <td mat-cell *matCellDef="let element" class="py-3 px-4 border-t dark:border-gray-800!">
          {{ element.apellido }}
        </td>
      </ng-container>

      <!-- Email -->
      <ng-container matColumnDef="email">
        <th
          mat-header-cell
          *matHeaderCellDef
          class="text-left py-3 px-4 font-semibold bg-gray-100! dark:bg-[#0f172a]!"
        >
          Email
        </th>
        <td mat-cell *matCellDef="let element" class="py-3 px-4 border-t dark:border-gray-800!">
          {{ element.email }}
        </td>
      </ng-container>

      <!-- Teléfono -->
      <ng-container matColumnDef="telefono">
        <th
          mat-header-cell
          *matHeaderCellDef
          class="text-left py-3 px-4 font-semibold bg-gray-100! dark:bg-[#0f172a]!"
        >
          Teléfono
        </th>
        <td mat-cell *matCellDef="let element" class="py-3 px-4 border-t dark:border-gray-800!">
          {{ element.telefono }}
        </td>
      </ng-container>

      <!-- Acciones -->
      <ng-container matColumnDef="acciones">
        <th
          mat-header-cell
          *matHeaderCellDef
          class="text-left py-3 px-4 font-semibold bg-gray-100! dark:bg-[#0f172a]!"
        >
          Acciones
        </th>
        <td mat-cell *matCellDef="let element" class="py-3! flex gap-2">
          <button
            mat-flat-button
            color="primary"
            class="bg-blue-600! hover:bg-blue-500! text-white px-3 py-1 rounded-md"
            (click)="actualizarClienteDialog(element)"
          >
            Editar
          </button>
          <button
            mat-flat-button
            color="warn"
            class="bg-red-600! hover:bg-red-500! text-white px-3 py-1 rounded-md"
            (click)="eliminarCliente(element.id)"
          >
            Eliminar
          </button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns" class="text-sm"></tr>
      <tr
        mat-row
        *matRowDef="let row; columns: displayedColumns"
        class="hover:bg-gray-50! dark:hover:bg-[#1e293b]/70!"
      ></tr>
    </table>
  </div>

  <div class="mt-3 text-sm text-gray-600 dark:text-gray-400">Total de registros: {{ total() }}</div>
</div>
